#!/usr/bin/env python3
# Use the system's default Python 3 interpreter

import os
import random
import subprocess

# Absolute path to the directory containing video files
VIDEO_DIR = "/home/Disk/files/Example address/"

# Collect all regular files in the directory (ignore subdirectories)
files = [
    f for f in os.listdir(VIDEO_DIR)
    if os.path.isfile(os.path.join(VIDEO_DIR, f))
]

# Stop execution if the directory contains no files
if not files:
    raise RuntimeError("Folder is empty")

# Randomly select one video file
selected_video = random.choice(files)
video_path = os.path.join(VIDEO_DIR, selected_video)

# Play the selected video using mpv
# This call blocks until the player is closed
subprocess.run(["mpv", video_path])

# Extract the file extension (e.g. .mp4, .mkv)
_, ext = os.path.splitext(selected_video)

def generate_unique_name():
    """
    Generate a unique 16-digit filename that:
    - Does not start with zero
    - Does not collide with existing files
    - Preserves the original file extension
    """
    while True:
        # First digit must be between 1 and 9
        first_digit = random.randint(1, 9)

        # Remaining 15 digits (can include zeros)
        other_digits = random.randint(0, 10**15 - 1)

        # Build a zero-padded 16-digit number as a string
        number = f"{first_digit}{other_digits:015d}"

        # Append original extension
        new_name = number + ext
        new_path = os.path.join(VIDEO_DIR, new_name)

        # Ensure filename uniqueness
        if not os.path.exists(new_path):
            return new_name

# Generate a new unique filename
new_filename = generate_unique_name()
new_path = os.path.join(VIDEO_DIR, new_filename)

# Rename the played video file after the player is closed
os.rename(video_path, new_path)
